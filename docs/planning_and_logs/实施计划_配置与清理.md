# 实施计划：配置与清理

> **模式**：计划模式  
> **依据**：用户反馈（requirements 已移入 configs、encoder 去 v2、删除 sts_path/window_policy、删除所有 test）

---

## 一、encoder_v2_ids.yaml 重命名为 encoder_ids.yaml

### 1.1 文件重命名

- **操作**：将 `configs/encoder_v2_ids.yaml` 重命名为 `configs/encoder_ids.yaml`
- **说明**：去掉版本号 v2，作为唯一 ID 映射表

### 1.2 代码引用更新

| 文件 | 修改内容 |
|------|----------|
| `src/training/encoder_utils.py` | 第 5 行 docstring：`encoder_v2_ids.yaml` → `encoder_ids.yaml` |
| `src/training/encoder_utils.py` | 第 16 行：`_IDS_PATH = ... / "encoder_v2_ids.yaml"` → `"encoder_ids.yaml"` |
| `src/training/encoder_utils.py` | 第 34 行 `_load_ids` 注释：`encoder_v2_ids.yaml` → `encoder_ids.yaml` |
| `scripts/extract_ids_from_raw.py` | 第 4 行 docstring：`encoder_v2_ids.yaml` → `encoder_ids.yaml` |

### 1.3 文档引用更新

| 文件 | 修改内容 |
|------|----------|
| `README.md` | 第 31、44、51 行：`encoder_v2_ids` → `encoder_ids` |
| `docs/状态向量s_技术规范.md` | 第 59、68 行：`encoder_v2_ids.yaml` → `encoder_ids.yaml` |
| `docs/planning_and_logs/状态向量s_穷尽计划.md` | 第 224、240 行：`encoder_v2_ids.yaml` → `encoder_ids.yaml` |
| `docs/planning_and_logs/状态向量s_穷尽计划_详细版.md` | 第 43、65、247、386、438 行：`encoder_v2_ids` → `encoder_ids` |
| `docs/杀戮尖塔_官方本体A20_卡牌遗物穷尽清单.md` | 第 130、217、219、230、231 行：`encoder_v2_ids` → `encoder_ids` |
| `docs/planning_and_logs/项目文件必要性审查计划.md` | 第 27、94 行：`encoder_v2_ids` → `encoder_ids` |

---

## 二、requirements 引用更新

- **现状**：`configs/requirements.md` 已存在，根目录无 `requirements.md`
- **操作**：将 README 及文档中对 `requirements.md` 的引用改为 `configs/requirements.md`

| 文件 | 修改内容 |
|------|----------|
| `README.md` | 第 104 行：`requirements.md` → `configs/requirements.md` |
| `README.md` | 第 132 行：`requirements.md` 有列表 → `configs/requirements.md` 有列表 |
| `docs/planning_and_logs/项目文件必要性审查计划.md` | 第 15 行：`requirements.md` → `configs/requirements.md`（若该文档描述根目录文件结构） |

---

## 三、sts_path.txt、window_policy.txt 引用清理

- **现状**：用户已删除，configs 中已无此二文件
- **操作**：从 README 和文档中移除对二者的描述

| 文件 | 修改内容 |
|------|----------|
| `README.md` | 第 52-53 行：删除 `sts_path.txt`、`window_policy.txt` 两行 |
| `docs/planning_and_logs/项目文件必要性审查计划.md` | 第 28-29 行：删除或标注「已删除」 |

---

## 四、删除所有 test 文件

### 4.1 删除的目录与文件

| 路径 | 说明 |
|------|------|
| `tests/test_agents/test_base.py` | Agent 基类测试 |
| `tests/test_agents/test_rule_based.py` | 规则 Agent 测试 |
| `tests/test_agents/test_supervised.py` | 监督 Agent 测试 |
| `tests/test_agents/test_rl_agent.py` | RL Agent 测试 |
| `tests/test_core/test_game_state.py` | GameState 测试 |
| `tests/test_core/test_action_exhaustive.py` | 动作穷尽测试 |
| `tests/test_env/test_sts_env.py` | 环境测试 |
| `tests/test_protocol/test_reader.py` | Reader 测试 |
| `tests/test_training/test_encoder.py` | Encoder 测试 |
| `tests/test_training/test_experiment.py` | Experiment 测试 |
| `tests/test_agents/` | 空目录删除 |
| `tests/test_core/` | 空目录删除 |
| `tests/test_env/` | 空目录删除 |
| `tests/test_protocol/` | 空目录删除 |
| `tests/test_training/` | 空目录删除 |
| `tests/__init__.py` | 删除 |

### 4.2 保留或删除 tests/ 根目录

- **选项 A**：删除整个 `tests/` 目录
- **选项 B**：保留 `tests/` 空目录及 `__init__.py`，便于日后恢复测试

**建议**：选项 A，彻底移除 tests。

### 4.3 文档与配置更新

| 文件 | 修改内容 |
|------|----------|
| `README.md` | 项目结构中的 `tests/` 及其子目录描述全部删除 |
| `docs/planning_and_logs/项目文件必要性审查计划.md` | 删除或更新与 tests 相关的审查条目 |

---

## 五、实施检查清单

按顺序执行以下原子操作：

**阶段 1：encoder_ids 重命名** ✅

1. [x] 将 `configs/encoder_v2_ids.yaml` 重命名为 `configs/encoder_ids.yaml`
2. [x] 修改 `src/training/encoder_utils.py` 中 3 处 `encoder_v2_ids` 为 `encoder_ids`
3. [x] 修改 `scripts/extract_ids_from_raw.py` 中 1 处 `encoder_v2_ids` 为 `encoder_ids`
4. [x] 修改 `README.md` 中 3 处 `encoder_v2_ids` 为 `encoder_ids`
5. [x] 修改 `docs/状态向量s_技术规范.md` 中 2 处
6. [x] 修改 `docs/planning_and_logs/状态向量s_穷尽计划.md` 中 2 处
7. [x] 修改 `docs/planning_and_logs/状态向量s_穷尽计划_详细版.md` 中 5 处
8. [x] 修改 `docs/杀戮尖塔_官方本体A20_卡牌遗物穷尽清单.md` 中 5 处
9. [x] 修改 `docs/planning_and_logs/项目文件必要性审查计划.md` 中 2 处

**阶段 2：requirements 引用** ✅

10. [x] 修改 `README.md` 中 2 处 `requirements.md` 为 `configs/requirements.md`
11. [x] 修改 `docs/planning_and_logs/项目文件必要性审查计划.md` 中 1 处（若适用）

**阶段 3：sts_path、window_policy 引用清理** ✅

12. [x] 修改 `README.md`：删除 sts_path.txt、window_policy.txt 两行
13. [x] 修改 `docs/planning_and_logs/项目文件必要性审查计划.md`：删除或标注该二文件已删除

**阶段 4：删除 tests** ✅

14. [x] 删除 `tests/test_agents/test_base.py`
15. [x] 删除 `tests/test_agents/test_rule_based.py`
16. [x] 删除 `tests/test_agents/test_supervised.py`
17. [x] 删除 `tests/test_agents/test_rl_agent.py`
18. [x] 删除 `tests/test_core/test_game_state.py`
19. [x] 删除 `tests/test_env/test_sts_env.py`
20. [x] 删除 `tests/test_protocol/test_reader.py`
21. [x] 删除 `tests/test_training/test_encoder.py`
22. [x] 删除 `tests/test_training/test_experiment.py`
23. [x] 删除 `tests/__init__.py`
24. [x] 删除空目录及 `tests/` 目录
25. [x] 修改 `README.md`：删除项目结构中的 tests 相关描述

---

## 六、不纳入本计划的项

- **sts_env.py、rl_agent.py、supervised.py**：依赖 StateEncoder，待 s 向量完善后统一改为使用新 encoder，不在此次计划中修改。
- **action.py、game_state.py**：无修改，保持现状。
